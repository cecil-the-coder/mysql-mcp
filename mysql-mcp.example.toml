# mysql-mcp example configuration file
# Copy this to mysql-mcp.toml and customize as needed.
# Environment variables take precedence over values set here.

[connection]
# MySQL host (default: localhost)
host = "localhost"

# MySQL port (default: 3306)
port = 3306

# Unix socket path (takes precedence over host:port when set)
# socket = "/var/run/mysqld/mysqld.sock"

# MySQL user (default: root)
user = "root"

# MySQL password
password = ""

# Target database (leave empty for multi-database mode)
# database = "myapp"

# Full MySQL connection URL (overrides individual connection fields when set)
# connection_string = "mysql://user:pass@host:3306/database"

[pool]
# Maximum number of connections in the pool (default: 20)
size = 20

# Maximum time (ms) to wait for a query to complete (default: 30000)
query_timeout_ms = 30000

# Maximum time (ms) to wait for a connection to be established (default: 10000)
connect_timeout_ms = 10000

# How long (seconds) to cache schema introspection results (default: 60)
# Set to 0 to disable caching
cache_ttl_secs = 60

# Maximum number of rows returned per query (default: 1000).
# Acts as a safety limit to prevent runaway queries from returning huge result sets.
# Set to a large number like 10000 for effectively unlimited rows.
# max_rows = 1000

# Number of connections to pre-open at startup (default: 1).
# Reduces latency on the first real queries by establishing connections in the background.
# warmup_connections = 1

# Wrap every SELECT in SET TRANSACTION READ ONLY (default: false).
# Provides an additional database-level guarantee that no writes can occur during SELECT.
# When false (the default), the server uses the faster single-round-trip path.
# readonly_transaction = false

# Performance hints control automatic EXPLAIN analysis (default: "none").
# Valid values:
#   "none"   — never run EXPLAIN automatically (default)
#   "auto"   — run EXPLAIN on queries that exceed slow_query_threshold_ms
#   "always" — run EXPLAIN before every SELECT and include the plan in the response
# performance_hints = "none"

# Threshold (ms) for automatic EXPLAIN when performance_hints = "auto" (default: 500).
# Queries that take longer than this will have their query plan included in the response.
# slow_query_threshold_ms = 500

[security]
# Allow INSERT operations (default: false)
allow_insert = false

# Allow UPDATE operations (default: false)
allow_update = false

# Allow DELETE operations (default: false)
allow_delete = false

# Allow DDL operations (CREATE, ALTER, DROP, TRUNCATE) (default: false)
allow_ddl = false

# Require SSL for MySQL connections (default: false)
ssl = false

# Allow write operations when operating in multi-database mode (no database set)
# (default: false)
multi_db_write_mode = false

# Maximum number of concurrent named sessions (not counting the default session).
# Prevents unbounded session creation when allow_runtime_connections is true.
# (default: 50)
# max_sessions = 50

# Per-schema permission overrides
# These take precedence over the global settings above.
# Useful for allowing writes to one database while keeping others read-only.
#
# Example: allow writes to 'app_db' but keep everything else read-only
# [security.schema_permissions.app_db]
# allow_insert = true
# allow_update = true
# allow_delete = false
# allow_ddl = false

[monitoring]
# Enable request logging (default: true)
logging = true

# Log level: error, warn, info, debug, trace (default: info)
log_level = "info"

# Enable Prometheus metrics (default: false)
metrics_enabled = false

# MySQL session timezone (optional)
# Examples: "UTC", "+08:00", "America/New_York"
# timezone = "UTC"

# Return date/datetime values as strings instead of native types (default: false)
date_strings = false

# ─── SSH Tunnel ───────────────────────────────────────────────────────────────
# Route the MySQL connection through an SSH tunnel (jump host / bastion).
# Useful when the database is not directly reachable from the machine running
# mysql-mcp (e.g., DB is in a private VPC, accessible only via a bastion host).
#
# Prerequisites:
#   macOS / Linux : OpenSSH is built-in. No extra installation needed.
#   Windows       : OpenSSH must be installed. Enable via Windows Features or:
#                   winget install Microsoft.OpenSSH.Beta
#                   Verify with: ssh -V
#
# [ssh]
# # Bastion / jump host (required to enable SSH tunneling)
# host = "bastion.example.com"
#
# # SSH server port (default: 22)
# port = 22
#
# # SSH user on the bastion (required)
# user = "ubuntu"
#
# # Path to PEM private key file (optional — omit to rely on SSH agent)
# private_key = "/home/user/.ssh/id_rsa"
#
# # Use the system SSH agent for authentication (MYSQL_SSH_USE_AGENT=true)
# use_agent = false
#
# # Host key verification mode (default: "strict")
# #   "strict"     — fail if the host key is unknown (most secure; pre-populate
# #                  known_hosts with: ssh-keyscan bastion >> ~/.ssh/known_hosts)
# #   "accept-new" — automatically add new host keys, verify known ones
# #   "insecure"   — skip all host key verification (not recommended)
# known_hosts_check = "strict"
#
# # Override the known_hosts file path (default: ~/.ssh/known_hosts)
# # known_hosts_file = "/etc/ssh/known_hosts"
